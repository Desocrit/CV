---
interface Props {
  company: string;
  role: string;
  tenure: string;
  summary: string;
  impact: string[];
  techStack: string[];
}

const { company, role, tenure, summary, impact, techStack } = Astro.props;

// Convert company to uppercase for label
const companyLabel = company.toUpperCase().replace(/'/g, '');
---

<li class="timeline-entry border-t border-border pt-fluid-sm pb-fluid-sm first:border-t-0 first:pt-0">
  <article class="entry-grid group">
    <!-- Left Column: Role, Tenure, Company, Tech Stack -->
    <div class="entry-meta mt-1">
      <h3 class="text-fluid-base font-medium tracking-tight text-foreground">{role}</h3>
      <p class="font-mono text-fluid-2xs text-muted-foreground opacity-60">
        <time>{tenure}</time>
      </p>

      <p class="company-label font-mono text-fluid-2xs uppercase tracking-widest mt-2">
        {companyLabel}
      </p>

      <!-- Tech stack as pills -->
      <div class="tech-pills mt-3 flex flex-wrap gap-1.5" data-print="hide">
        {techStack.filter(t => !t.startsWith('TODO')).slice(0, 4).map((item) => (
          <span class="tech-pill font-mono text-[10px] uppercase tracking-wider px-2 py-0.5 border border-border text-muted-foreground">
            {item}
          </span>
        ))}
      </div>
    </div>

    <!-- Right Column: Summary & Impact -->
    <div class="entry-content">
      <!-- Summary -->
      <p class="text-fluid-sm text-muted-foreground leading-relaxed">
        {summary}
      </p>

      <!-- Impact bullets -->
      <ul class="impact-list mt-fluid-xs space-y-1 font-mono text-fluid-xs">
        {impact.map((item) => {
          const cleanItem = item.replace(/^["']|["']$/g, '');
          return (
            <li class="flex items-start gap-2 text-muted-foreground">
              <span class="item-separator shrink-0 mt-0.5" aria-hidden="true">-</span>
              <span>{cleanItem}</span>
            </li>
          );
        })}
      </ul>
    </div>
  </article>
</li>

<style>
  /* Two-column grid layout */
  .entry-grid {
    display: grid;
    grid-template-columns: minmax(140px, 180px) 1fr;
    gap: var(--spacing-fluid-md);
  }

  /* Company label - purple accent */
  .company-label {
    color: var(--color-accent-purple);
  }

  /* Tech pills styling */
  .tech-pill {
    border-radius: 0;
  }

  /* Item separator - purple accent */
  .item-separator {
    color: var(--color-accent-purple);
  }

  /* Responsive: Stack on smaller screens */
  @media (max-width: 640px) {
    .entry-grid {
      grid-template-columns: 1fr;
      gap: var(--spacing-fluid-xs);
    }
  }

  /* Print: Compact display with bullet points */
  @media print {
    .timeline-entry {
      padding-top: 0.3rem;
      padding-bottom: 0.3rem;
    }

    .entry-grid {
      grid-template-columns: 1fr;
      gap: 0.25rem;
    }

    .company-label {
      color: #333 !important;
    }

    /* Convert to vertical bullet list */
    .impact-list {
      padding-left: 1rem !important;
    }

    .impact-list li {
      display: list-item !important;
      list-style-type: disc !important;
      margin: 0.1rem 0 !important;
    }

    /* Hide the separator */
    .item-separator {
      display: none !important;
    }
  }
</style>
