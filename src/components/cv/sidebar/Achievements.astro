---
/**
 * SidebarAchievements - Key achievements display
 *
 * Displays achievements in a two-column grid with aligned metrics.
 * Responsive styling for desktop, mobile, and print.
 */
import Odometer from '../../ui/Odometer.astro';
import Label from '../../typography/Label.astro';
import Metric from '../../typography/Metric.astro';
import Text from '../../typography/Text.astro';
import ScreenOnly from '../../layout/ScreenOnly.astro';
import PrintOnly from '../../layout/PrintOnly.astro';
import Stack from '../../layout/Stack.astro';

interface Achievement {
  metric: string;
  headline: string;
  description: string;
}

interface Props {
  achievements: Achievement[];
}

const { achievements } = Astro.props;

const toSnakeCase = (str: string) =>
  str.toUpperCase().replace(/\s+/g, '_');
---

<Stack
  as="section"
  gap="xs"
  class:list={[
    'sm:col-start-2 sm:row-span-3 sm:self-start',
    'print:mb-10',
  ]}
  aria-label="Key Achievements"
>
  <!-- Desktop & Light mode title (also shown in print) -->
  <Label
    as="h2"
    variant="section"
    class="hidden light:block sm:!hidden lg:!block print:!block"
  >
    Achievements
  </Label>

  <!-- Mobile dark mode terminal title -->
  <Label
    as="h2"
    variant="terminal"
    color="green"
    class="block light:hidden sm:hidden"
  >
    &gt; ACHIEVEMENTS
  </Label>

  <!-- Two-column grid with aligned metrics -->
  <div class="grid grid-cols-[auto_1fr] gap-x-2 gap-y-0.5">
    {achievements.map((achievement, index) => (
      <div class="contents">
        <Metric
          as="data"
          size="sm"
          value={achievement.headline}
          class="text-right self-baseline"
        >
          <Odometer value={achievement.headline} />
        </Metric>
        <Label variant="achievement" color="purple" class="self-baseline light:font-semibold">
          <!-- Dark mode terminal style: UPPERCASE_WITH_UNDERSCORES -->
          <ScreenOnly as="span" class="light:hidden">{toSnakeCase(achievement.metric)}</ScreenOnly>
          <!-- Light mode: lowercase with spaces -->
          <ScreenOnly as="span" class="hidden light:inline capitalize">{achievement.metric}</ScreenOnly>
          <PrintOnly as="span">{achievement.metric}</PrintOnly>
        </Label>
        <span class="col-span-2" aria-hidden="true"></span>
        <Text muted class:list={[
          'col-span-2 leading-snug max-w-[50ch]',
          index === achievements.length - 1 ? '' : 'mb-[var(--spacing-fluid-sm)]',
          'print:mt-0.5 print:mb-1.5',
        ]}>
          {achievement.description}
        </Text>
      </div>
    ))}
  </div>
</Stack>
