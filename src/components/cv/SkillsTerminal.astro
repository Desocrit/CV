---
import ScreenOnly from '../layout/ScreenOnly.astro';
import Heading from '../typography/Heading.astro';

interface SkillCategory {
  name: string;
  displayName: string;
  skills: string[];
}

interface Props {
  categories: SkillCategory[];
  sectionNumber?: string;
}

const { categories, sectionNumber = '03' } = Astro.props;

const toSnakeCase = (str: string) =>
  str.toLowerCase().replace(/\s+/g, '_').replace(/[()]/g, '');
---

<section aria-label="Skills" class="mt-fluid-lg mb-fluid-md">
  <Heading
    as="h2"
    class="mb-fluid-sm flex items-baseline gap-2 border-b border-border pb-fluid-xs print:text-[10px] print:font-bold print:tracking-[0.06em] print:text-[var(--color-print-body)] print:border-[#e5e5e5] print:pb-1 print:mb-1.5"
  >
    <span class="section-prefix font-mono text-fluid-sm tracking-wider text-accent-green print:hidden" aria-hidden="true">
      // {sectionNumber}
    </span>
    <span class="font-mono text-fluid-sm tracking-wide print:text-[10px] print:uppercase">SKILLS</span>
  </Heading>

  <div class="bg-terminal-bg text-terminal-text font-mono overflow-hidden border border-border light:border-[0.5px] print:border-[var(--color-print-border)] print:bg-transparent print:p-[0.3rem]">
    <ScreenOnly class="terminal-header flex items-center gap-1 border-b border-border px-3 py-1.5" aria-hidden="true">
      <span class="size-2 rounded-full bg-[#FF5F56]"></span>
      <span class="size-2 rounded-full bg-[#FFBD2E]"></span>
      <span class="size-2 rounded-full bg-[#27C93F]"></span>
      <span class="ml-2 font-mono text-fluid-sm text-foreground opacity-70">capabilities.sh</span>
    </ScreenOnly>

    <div class="p-3 font-mono text-fluid-sm" role="region" aria-label="Skill categories">
      {categories.map((category, index) => (
        <div class:list={['terminal-command-group', index > 0 && 'mt-3']}>
          <p class="text-terminal-text flex items-center gap-1.5 print:hidden">
            <span class="terminal-dollar text-accent-green print:text-[var(--color-print-foreground)]">$</span>
            <span class="sr-only">Category:</span>
            <code class="terminal-command text-accent-purple print:text-[var(--color-print-foreground)]">cat</code>
            <code class="text-foreground">{toSnakeCase(category.name)}</code>
          </p>

          <ul
            class="mt-1 flex flex-wrap gap-x-1 gap-y-0.5 text-terminal-text print:inline print:mt-0"
            aria-label={category.displayName}
          >
            {category.skills.map((skill, i) => (
              <li class="inline print:inline">
                <span class="text-foreground">{skill}</span>
                {i < category.skills.length - 1 && <span class="text-muted-foreground">,</span>}
              </li>
            ))}
          </ul>
        </div>
      ))}

      <ScreenOnly class="mt-3 flex items-center gap-1.5">
        <span class="terminal-dollar text-accent-green">$</span>
        <span
          class="text-foreground animate-[blink_1s_step-end_infinite] motion-reduce:animate-none"
          aria-hidden="true"
        >_</span>
      </ScreenOnly>
    </div>
  </div>
</section>
