---
import { cva, type VariantProps } from 'class-variance-authority';

const label = cva(
  // Base: mono font, uppercase (light mode removes uppercase via global.css)
  ['font-mono', 'uppercase', 'light:normal-case', 'light:font-medium'],
  {
    variants: {
      variant: {
        // Default: Section labels, tags (matches ContentCard tag)
        default: [
          'text-fluid-xs',
          'text-muted-foreground',
          'print:text-[10px]',
          'print:text-[var(--color-print-muted)]',
        ],
        // Accent: Company labels with tracking (matches ContentCard .label-text)
        accent: [
          'text-fluid-xs',
          'tracking-widest',
          'print:text-[11px]',
          'print:normal-case',
          'print:tracking-normal',
          'print:text-[var(--color-print-muted)]',
        ],
        // Achievement: Sidebar achievement labels
        achievement: [
          'text-fluid-xs',
          'tracking-widest',
          'print:text-[10px]',
          'print:normal-case',
          'print:tracking-[0.02em]',
          'print:text-[var(--color-print-muted)]',
        ],
        // Micro: Smallest labels (used in TechStackPrint section titles)
        micro: [
          'text-fluid-xs',
          'tracking-widest',
          'text-muted-foreground',
          'light:tracking-wider',
          // Print: matches section anchor style - 10px, bold, dark grey, line under
          'print:text-[10px]',
          'print:font-bold',
          'print:tracking-[0.06em]',
          'print:text-[var(--color-print-body)]',
          'print:border-solid',
          'print:border-b',
          'print:border-[var(--color-print-border)]',
          'print:pb-1',
          'print:mb-1.5',
          'print:w-fit',
        ],
        // Plain: No uppercase transform, for location/subtitle text (sans-serif in print)
        plain: [
          'text-fluid-xs',
          'text-muted-foreground',
          '!normal-case',
          'light:normal-case',
          'print:font-sans',
          'print:text-[11px]',
          'print:tracking-normal',
          'print:text-[var(--color-print-muted)]',
        ],
        // Section: Sidebar section titles with border underline
        section: [
          'text-fluid-xs',
          'font-medium',
          'tracking-widest',
          'text-[var(--color-muted-foreground-light)]',
          'border-b',
          'border-[var(--color-muted-foreground)]',
          'pb-1.5',
          'block',
          'w-fit',
          'light:mb-2',
          'sm:w-full',
          'light:sm:mb-0',
          'light:!uppercase',
          // Desktop lg: tighter spacing
          'lg:pb-1',
          'lg:mb-1',
          // Print: 10px, bold, sans-serif, dark grey, thin line under
          'print:block',
          'print:uppercase',
          'print:font-sans',
          'print:text-[10px]',
          'print:font-bold',
          'print:tracking-[0.06em]',
          'print:text-[var(--color-print-body)]',
          'print:border-solid',
          'print:border-b',
          'print:border-t-0',
          'print:border-[var(--color-print-border)]',
          'print:w-full',
          'print:pb-3',
          'print:mb-3',
          'print:leading-tight',
        ],
        // Subtitle: Category headers like "01 / EFFICIENCY" - whisper quiet metadata
        subtitle: [
          'text-fluid-xs',
          'font-medium',
          'tracking-widest',
          'text-muted-foreground-light',
          'uppercase',
          // Print: 9px, medium weight, subtle tracking, light grey, NO border
          'print:text-[9px]',
          'print:font-medium',
          'print:tracking-[0.03em]',
          'print:text-[#888888]',
          'print:border-none',
        ],
        // Terminal: Terminal-style prompt text (mobile dark mode, hidden in print)
        terminal: [
          'text-fluid-sm',
          'font-medium',
          '!normal-case',
          'print:hidden',
        ],
        // Contact: Print contact field labels (sans-serif, semibold)
        contact: [
          'text-fluid-xs',
          'text-muted-foreground',
          '!normal-case',
          'print:font-sans',
          'print:text-[10px]',
          'print:font-semibold',
          'print:text-[var(--color-print-foreground)]',
          'print:leading-tight',
        ],
        // Tech: Tech group names (sans-serif for print)
        tech: [
          'text-fluid-xs',
          'tracking-widest',
          'print:font-sans',
          'print:text-[10px]',
          'print:font-semibold',
          'print:text-[var(--color-print-foreground)]',
          'print:leading-tight',
          'print:normal-case',
          'print:mb-px',
          'print:uppercase'
        ],
        // Card header: Impact/Content card category headers with brackets
        cardHeader: [
          'text-fluid-2xs',
          'font-normal',
          'tracking-widest',
          'opacity-50',
          'transition-opacity',
          'duration-150',
          'ease-out',
          // Light mode overrides
          'light:!capitalize',
          'light:!font-semibold',
          'light:tracking-wider',
          'light:opacity-80',
          // Print: monospace, 10px, medium grey - the "I code" signal
          'print:font-mono',
          'print:text-[10px]',
          'print:normal-case',
          'print:opacity-100',
          'print:text-[var(--color-print-muted)]',
        ],
      },
      color: {
        default: '',
        muted: 'text-muted-foreground',
        foreground: 'text-foreground',
        purple: 'text-accent-purple',
        green: 'text-accent-green',
        blue: 'text-accent-blue',
        orange: 'text-accent-orange',
      },
    },
    defaultVariants: {
      variant: 'default',
      color: 'default',
    },
  }
);

type LabelVariants = VariantProps<typeof label>;
type VariantKey = NonNullable<LabelVariants['variant']>;

interface Props extends Omit<LabelVariants, 'variant'> {
  as?: 'span' | 'div' | 'label' | 'p' | 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6' | 'time';
  class?: string;
  variant?: VariantKey;
  // Boolean variant props - use `<Label section>` instead of `<Label variant="section">`
  accent?: boolean;
  achievement?: boolean;
  micro?: boolean;
  plain?: boolean;
  section?: boolean;
  subtitle?: boolean;
  terminal?: boolean;
  contact?: boolean;
  tech?: boolean;
  cardHeader?: boolean;
}

const {
  as: Tag = 'span',
  variant,
  color = 'default',
  class: className,
  // Boolean variants
  accent,
  achievement,
  micro,
  plain,
  section,
  subtitle,
  terminal,
  contact,
  tech,
  cardHeader,
  ...attrs
} = Astro.props as Props;

// Resolve variant from boolean props or explicit variant prop
const resolvedVariant: VariantKey = accent ? 'accent'
  : achievement ? 'achievement'
  : micro ? 'micro'
  : plain ? 'plain'
  : section ? 'section'
  : subtitle ? 'subtitle'
  : terminal ? 'terminal'
  : contact ? 'contact'
  : tech ? 'tech'
  : cardHeader ? 'cardHeader'
  : variant ?? 'default';

const classes = label({ variant: resolvedVariant, color, class: className });
---

<Tag class={classes} {...attrs}>
  <slot />
</Tag>
